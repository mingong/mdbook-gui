<!DOCTYPE html>
<html>

<head>
  <title> </title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>

<body style="font-family: 'Noto Sans Mono CJK TC', 'Noto Sans Mono CJK TC', Serif;font-size: 18px;">
  <h1 class="postTitle" style="margin: 0px 0px 20px; padding: 0px; font-size: 28px; font-weight: 400; line-height: 1.8; color: #333333; font-family: 'PingFang SC',      'Microsoft YaHei', 'Helvetica Neue',      Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><a class="postTitle2
        vertical-middle" href="C%23%20.Net%20Core%203.1%20中关于Process.Start%20启动Url链接的问题.html"><span style="margin: 0px; padding: 0px; vertical-align: middle;">C# .Net Core 3.1 中关于Process.Start 启动Url链接的问题</span></a></h1>
  <div class="postBody" style="margin: 0px; padding: 0px; color: #7d8b8d; font-family: 'PingFang SC',      'Microsoft YaHei', 'Helvetica Neue',      Helvetica, Arial, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">
    <div id="cnblogs_post_body" class="blogpost-body
        blogpost-body-html" style="margin: 0px 0px 20px; padding: 0px; word-break: break-word; color: #333333; line-height: 1.8;">
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">WPF 项目迁移到.Net Core中时居然出了一堆问题...(很无语)</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">今天<br />在使用的时候居然发现Process.Start居然打不开Url链接了？ 报 找不到指定文件 的异常？！</p>
      <h1 style="margin: 10px 0px; padding: 0px; font-size: 28px; font-weight: bold; line-height: 1.5;">一、bug重现</h1>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">首先<br />以.Net Core 3.1框架 中一个Console项目&nbsp; 打开百度为例:</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;"><img src="1188749-20200315160302099-148966890.png" alt="" border="0" /></p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">&nbsp;</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">运行<br />然后你就会得到:</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;"><img src="1188749-20200315160234202-2033210592.png" alt="" border="0" /></p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">&nbsp;</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">纳闷<br />的是，这种方法打开Url在.Net Framework中是没问题的..</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">&nbsp;</p>
      <h1 style="margin: 10px 0px; padding: 0px; font-size: 28px; font-weight: bold; line-height: 1.5;">二、解决方法</h1>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">方案<br />一：使用windows系统自带的资源管理器来打开Url</p>
      <div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: #f5f5f5; border: 1px solid          #cccccc; overflow: auto; color: #000000; font-family: 'Courier New' !important; font-size: 12px !important;">
        <pre style="margin: 0px; padding: 0px; overflow: auto; overflow-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important; white-space: pre-wrap;">Process.Start(<span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">explorer</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span>, <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">https://www.baidu.com</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span>);</pre>
      </div>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">你就<br />可以得到一个浏览器窗口，打开着百度网页..</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">但是<br />如果你的Url复杂一点的话，例如打开百度搜索what</p>
      <div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: #f5f5f5; border: 1px solid          #cccccc; overflow: auto; color: #000000; font-family: 'Courier New' !important; font-size: 12px !important;">
        <pre style="margin: 0px; padding: 0px; overflow: auto; overflow-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important; white-space: pre-wrap;">Process.Start(<span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">explorer</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span>, <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">https://www.baidu.com/s?wd=what</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span>);</pre>
      </div>
      <pre style="margin: 0px; padding: 0px; overflow: auto; white-space: pre-wrap;">explorer表示不干，并直接给你抛了个文件管理器窗口<br style="margin: 0px; padding: 0px;" /><br style="margin: 0px; padding: 0px;" />所以这个方法只可以用于打开简单的URL...<br style="margin: 0px; padding: 0px;" /><br style="margin: 0px; padding: 0px;" />方案二：使用cmd中的start命令 可以打开任意形式的URL</pre>
      <div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; background-color: #f5f5f5; border: 1px solid          #cccccc; overflow: auto; color: #000000; font-family: 'Courier New' !important; font-size: 12px !important;">
        <div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px; background-color: #f5f5f5;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px              5px 0px 0px; font-family: 'Courier New'              !important; font-size: 12px !important; line-height: 1.5              !important;"><a title="复制代码"><img src="copycode.gif" alt="复制代码" border="0" /></a></span></div>
        <pre style="margin: 0px; padding: 0px; overflow: auto; overflow-wrap: break-word; font-family: 'Courier New' !important; font-size: 12px !important; white-space: pre-wrap;"><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #0000ff;">string</span> url = <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">https://www.baidu.com/s?wd=what</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #000000;">;
Process p </span>= <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #0000ff;">new</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #000000;"> Process();
p.StartInfo.FileName </span>= <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">cmd.exe</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #000000;">;
p.StartInfo.UseShellExecute </span>= <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #0000ff;">false</span>;    <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">//</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">不使用shell启动</span>
p.StartInfo.RedirectStandardInput = <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #0000ff;">true</span>;<span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">//</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">喊cmd接受标准输入</span>
p.StartInfo.RedirectStandardOutput = <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #0000ff;">false</span>;<span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">//</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">不想听cmd讲话所以不要他输出</span>
p.StartInfo.RedirectStandardError = <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #0000ff;">true</span>;<span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">//</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">重定向标准错误输出</span>
p.StartInfo.CreateNoWindow = <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #0000ff;">true</span>;<span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">//</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">不显示窗口</span>
<span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #000000;">p.Start();

</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">//</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">向cmd窗口发送输入信息 后面的&amp;exit告诉cmd运行好之后就退出</span>
p.StandardInput.WriteLine(<span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">start </span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span>+url + <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">&amp;exit</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #800000;">"</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #000000;">);
p.StandardInput.AutoFlush </span>= <span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #0000ff;">true</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #000000;">;
p.WaitForExit();</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">//</span><span style="margin: 0px; padding: 0px; font-family: 'Courier New' !important; font-size: 12px !important; line-height: 1.5 !important; color: #008000;">等待程序执行完退出进程</span>
p.Close();</pre>
        <div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px; background-color: #f5f5f5;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px              5px 0px 0px; font-family: 'Courier New'              !important; font-size: 12px !important; line-height: 1.5              !important;"><a title="复制代码"><img src="copycode.gif" alt="复制代码" border="0" /></a></span></div>
      </div>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">OK</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">&nbsp;</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">以上<br />的问题我只在Windows平台上找到过，不知Linux和OSX有没有...</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">&nbsp;</p>
      <p style="margin: 10px auto; padding: 0px; text-indent: 0px;">Thanks</p>
    </div>
  </div>
  <p>&nbsp;</p>
</body>

</html>